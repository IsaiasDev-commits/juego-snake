<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Game Mejorado</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Press Start 2P', cursive;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: white;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: hidden;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 800px;
            z-index: 10;
            position: relative;
        }
        
        /* Fondo animado con CSS puro - optimizado para móviles */
        .background-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
            pointer-events: none;
        }
        
        .bg-circle {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            animation: float 15s infinite linear;
        }
        
        .bg-circle:nth-child(1) {
            width: 60px;
            height: 60px;
            top: 10%;
            left: 10%;
            animation-delay: 0s;
            animation-duration: 20s;
        }
        
        .bg-circle:nth-child(2) {
            width: 40px;
            height: 40px;
            top: 20%;
            left: 80%;
            animation-delay: 2s;
            animation-duration: 15s;
        }
        
        .bg-circle:nth-child(3) {
            width: 70px;
            height: 70px;
            top: 70%;
            left: 25%;
            animation-delay: 4s;
            animation-duration: 25s;
        }
        
        .bg-circle:nth-child(4) {
            width: 30px;
            height: 30px;
            top: 50%;
            left: 90%;
            animation-delay: 6s;
            animation-duration: 18s;
        }
        
        .bg-circle:nth-child(5) {
            width: 50px;
            height: 50px;
            top: 80%;
            left: 70%;
            animation-delay: 8s;
            animation-duration: 22s;
        }
        
        @keyframes float {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 0.5;
            }
            50% {
                opacity: 0.7;
            }
            100% {
                transform: translateY(-100vh) rotate(720deg);
                opacity: 0;
            }
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #ffdd40;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 5px rgba(255, 221, 64, 0.5); }
            50% { box-shadow: 0 0 20px rgba(255, 221, 64, 0.8); }
            100% { box-shadow: 0 0 5px rgba(255, 221, 64, 0.5); }
        }
        
        h1 {
            font-size: 1.5rem;
            text-shadow: 3px 3px 0 #000;
            margin-right: 15px;
        }
        
        .score-board {
            display: flex;
            gap: 15px;
        }
        
        .score-board p {
            font-size: 0.8rem;
            background: rgba(0, 0, 0, 0.5);
            padding: 8px 12px;
            border-radius: 5px;
        }
        
        #gameContainer {
            position: relative;
            width: 100%;
            margin: 0 auto;
            border: 4px solid #ffdd40;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        #background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(45deg, rgba(40, 44, 52, 0.9), rgba(30, 34, 42, 0.9)),
                repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(0, 0, 0, 0.1) 10px, rgba(0, 0, 0, 0.1) 20px);
            z-index: 1;
            opacity: 0.9;
            animation: subtleBackground 20s linear infinite;
            background-size: 200% 200%;
        }
        
        @keyframes subtleBackground {
            0% { background-position: 0% 0%; }
            100% { background-position: 100% 100%; }
        }
        
        canvas {
            display: block;
            width: 100%;
            background: rgba(40, 44, 52, 0.8);
            z-index: 2;
            position: relative;
        }
        
        #gameOverlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 3;
        }
        
        .screen {
            background: rgba(0, 0, 0, 0.9);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            border: 3px solid #ffdd40;
            max-width: 90%;
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .screen h2 {
            margin-bottom: 15px;
            color: #ffdd40;
            font-size: 1.5rem;
            text-shadow: 2px 2px 0 #000;
        }
        
        .screen p {
            margin: 12px 0;
            line-height: 1.5;
            font-size: 0.8rem;
        }
        
        .btn {
            background: linear-gradient(to bottom, #ffdd40, #ff9900);
            color: #000;
            border: none;
            padding: 12px 25px;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
            border-radius: 5px;
            cursor: pointer;
            margin: 12px 0;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 221, 64, 0.4);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .controls {
            margin-top: 15px;
            font-size: 0.6rem;
            color: #aaa;
        }
        
        .hidden {
            display: none !important;
        }
        
        .game-controls {
            position: absolute;
            bottom: 20px;
            right: 20px;
            z-index: 10;
        }
        
        .icon-btn {
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: 2px solid #ffdd40;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .icon-btn:hover {
            background: rgba(255, 221, 64, 0.2);
        }
        
        /* Controles móviles */
        .mobile-controls {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .direction-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 5px;
        }
        
        .control-btn {
            width: 50px;
            height: 50px;
            background: rgba(255, 221, 64, 0.7);
            border: 2px solid #ff9900;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 18px;
            color: #000;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }
        
        .control-btn:active {
            background: rgba(255, 221, 64, 1);
            transform: scale(0.95);
        }
        
        .up-btn {
            grid-column: 2;
            grid-row: 1;
        }
        
        .left-btn {
            grid-column: 1;
            grid-row: 2;
        }
        
        .right-btn {
            grid-column: 3;
            grid-row: 2;
        }
        
        .down-btn {
            grid-column: 2;
            grid-row: 3;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .action-btn {
            width: 50px;
            height: 50px;
            background: rgba(255, 87, 34, 0.7);
            border: 2px solid #c53b13;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 18px;
            color: white;
        }
        
        .action-btn:active {
            background: rgba(255, 87, 34, 1);
            transform: scale(0.95);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 12px;
            }
            
            h1 {
                font-size: 1.2rem;
                margin-right: 0;
                text-align: center;
            }
            
            .score-board {
                justify-content: center;
                width: 100%;
            }
            
            .screen {
                padding: 20px;
            }
            
            .screen h2 {
                font-size: 1.2rem;
            }
            
            .btn {
                padding: 10px 20px;
                font-size: 0.7rem;
            }
            
            .control-btn, .action-btn {
                width: 45px;
                height: 45px;
                font-size: 16px;
            }
        }
        
        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            h1 {
                font-size: 1rem;
            }
            
            .score-board {
                flex-direction: column;
                gap: 8px;
            }
            
            .score-board p {
                font-size: 0.7rem;
            }
            
            .screen {
                padding: 15px;
            }
            
            .screen h2 {
                font-size: 1rem;
                margin-bottom: 10px;
            }
            
            .screen p {
                font-size: 0.7rem;
            }
            
            .control-btn, .action-btn {
                width: 40px;
                height: 40px;
                font-size: 14px;
            }
            
            .bg-circle {
                animation-duration: 12s !important;
            }
        }
        
        @media (max-width: 350px) {
            .mobile-controls {
                transform: scale(0.9);
            }
        }
    </style>
</head>
<body>
    <!-- Fondo animado con CSS puro -->
    <div class="background-animation">
        <div class="bg-circle"></div>
        <div class="bg-circle"></div>
        <div class="bg-circle"></div>
        <div class="bg-circle"></div>
        <div class="bg-circle"></div>
    </div>

    <div class="container">
        <header>
            <h1>Snake Adventure</h1>
            <div class="score-board">
                <p>Puntaje: <span id="score">0</span></p>
                <p>Record: <span id="highScore">0</span></p>
            </div>
        </header>

        <div id="gameContainer">
            <div id="background"></div>
            <div id="gameOverlay">
                <div id="startScreen" class="screen">
                    <h2>Snake Adventure</h2>
                    <p>Usa las flechas o WASD para mover la serpiente</p>
                    <button id="startButton" class="btn">Comenzar Juego</button>
                    
                    <div class="controls">
                        <p>En móvil: Usa los botones de abajo o desliza el dedo</p>
                    </div>
                </div>
                <div id="pauseScreen" class="screen hidden">
                    <h2>Juego Pausado</h2>
                    <button id="resumeButton" class="btn">Continuar</button>
                </div>
                <div id="gameOverScreen" class="screen hidden">
                    <h2>¡Game Over!</h2>
                    <p>Puntaje: <span id="finalScore">0</span></p>
                    <button id="restartButton" class="btn">Jugar de Nuevo</button>
                </div>
            </div>
            
            <canvas id="gameCanvas"></canvas>
        </div>

        <div class="game-controls">
            <button id="pauseButton" class="icon-btn hidden" aria-label="Pausar juego">⏸️</button>
        </div>
        
        <!-- Controles móviles -->
        <div class="mobile-controls">
            <div class="direction-buttons">
                <button class="control-btn up-btn" id="upButton">↑</button>
                <button class="control-btn left-btn" id="leftButton">←</button>
                <button class="control-btn right-btn" id="rightButton">→</button>
                <button class="control-btn down-btn" id="downButton">↓</button>
            </div>
            <div class="action-buttons">
                <button class="action-btn" id="actionPause">⏸️</button>
                <button class="action-btn" id="actionRestart">↻</button>
            </div>
        </div>
    </div>

    <script>
        class SnakeGame {
            constructor() {
                this.canvas = document.getElementById("gameCanvas");
                this.ctx = this.canvas.getContext("2d");
                this.scoreDisplay = document.getElementById("score");
                this.highScoreDisplay = document.getElementById("highScore");
                this.finalScoreDisplay = document.getElementById("finalScore");
                
                // Pantallas
                this.startScreen = document.getElementById("startScreen");
                this.pauseScreen = document.getElementById("pauseScreen");
                this.gameOverScreen = document.getElementById("gameOverScreen");
                
                // Botones
                this.startButton = document.getElementById("startButton");
                this.restartButton = document.getElementById("restartButton");
                this.resumeButton = document.getElementById("resumeButton");
                this.pauseButton = document.getElementById("pauseButton");
                
                // Botones móviles
                this.upButton = document.getElementById("upButton");
                this.leftButton = document.getElementById("leftButton");
                this.rightButton = document.getElementById("rightButton");
                this.downButton = document.getElementById("downButton");
                this.actionPause = document.getElementById("actionPause");
                this.actionRestart = document.getElementById("actionRestart");
                
                // Configuración del juego
                this.box = 20;
                this.snake = [];
                this.dx = 0;
                this.dy = 0;
                this.food = {};
                this.score = 0;
                this.highScore = localStorage.getItem('snakeHighScore') || 0;
                this.gameInterval = null;
                this.isPaused = false;
                this.gameStarted = false;
                this.touchStartX = 0;
                this.touchStartY = 0;
                
                // Inicializar el juego
                this.init();
            }
            
            init() {
                // Ajustar el canvas
                this.resizeCanvas();
                window.addEventListener("resize", () => this.resizeCanvas());
                
                // Actualizar record
                this.highScoreDisplay.textContent = this.highScore;
                
                // Event listeners para botones
                this.startButton.addEventListener("click", () => this.startGame());
                this.restartButton.addEventListener("click", () => this.startGame());
                this.resumeButton.addEventListener("click", () => this.togglePause());
                this.pauseButton.addEventListener("click", () => this.togglePause());
                
                // Event listeners para botones móviles
                this.upButton.addEventListener("click", () => this.handleDirectionButton('up'));
                this.leftButton.addEventListener("click", () => this.handleDirectionButton('left'));
                this.rightButton.addEventListener("click", () => this.handleDirectionButton('right'));
                this.downButton.addEventListener("click", () => this.handleDirectionButton('down'));
                this.actionPause.addEventListener("click", () => this.togglePause());
                this.actionRestart.addEventListener("click", () => this.startGame());
                
                // Event listeners para teclado y touch
                document.addEventListener("keydown", (e) => this.handleKeyDown(e));
                document.addEventListener("touchstart", (e) => this.handleTouchStart(e), { passive: false });
                document.addEventListener("touchmove", (e) => this.handleTouchMove(e), { passive: false });
                
                // Dibujar pantalla de inicio
                this.drawStartScreen();
            }
            
            resizeCanvas() {
                // Ajustar el tamaño del canvas para que sea responsivo
                const maxWidth = Math.min(600, window.innerWidth - 40);
                const maxHeight = Math.min(500, window.innerHeight - 250);
                
                const width = Math.floor(maxWidth / this.box) * this.box;
                const height = Math.floor(maxHeight / this.box) * this.box;
                
                this.canvas.width = width;
                this.canvas.height = height;
                
                if (this.gameStarted && !this.isPaused) {
                    this.food = this.generateFood();
                }
            }
            
            drawStartScreen() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                // Título
                this.ctx.fillStyle = '#ffdd40';
                this.ctx.font = '20px "Press Start 2P", cursive';
                this.ctx.textAlign = 'center';
                this.ctx.fillText('Snake Adventure', this.canvas.width / 2, this.canvas.height / 3);
                
                // Instrucciones
                this.ctx.fillStyle = '#ffffff';
                this.ctx.font = '10px "Press Start 2P", cursive';
                this.ctx.fillText('Usa las flechas o WASD para mover', this.canvas.width / 2, this.canvas.height / 2);
                this.ctx.fillText('Presiona P para pausar', this.canvas.width / 2, this.canvas.height / 2 + 20);
                
                // Dibujar una serpiente de ejemplo
                this.ctx.fillStyle = '#4caf50';
                for (let i = 0; i < 5; i++) {
                    if (i === 0) {
                        this.ctx.fillStyle = '#ff5722';
                    } else {
                        this.ctx.fillStyle = '#4caf50';
                    }
                    this.ctx.fillRect(this.canvas.width / 2 - 40 + i * 18, this.canvas.height * 2/3, 16, 16);
                }
                
                // Dibujar una manzana de ejemplo
                this.ctx.fillStyle = '#ff0000';
                this.ctx.beginPath();
                this.ctx.arc(this.canvas.width / 2 + 35, this.canvas.height * 2/3 + 8, 8, 0, Math.PI * 2);
                this.ctx.fill();
            }
            
            startGame() {
                // Ocultar pantallas
                this.startScreen.classList.add('hidden');
                this.gameOverScreen.classList.add('hidden');
                this.pauseScreen.classList.add('hidden');
                
                // Mostrar botón de pausa
                this.pauseButton.classList.remove('hidden');
                
                // Reiniciar variables del juego
                this.snake = [{ x: this.box * 5, y: this.box * 5 }];
                this.dx = this.box;
                this.dy = 0;
                this.score = 0;
                this.scoreDisplay.textContent = this.score;
                this.isPaused = false;
                this.gameStarted = true;
                
                // Generar comida
                this.food = this.generateFood();
                
                // Limpiar intervalo anterior si existe
                if (this.gameInterval) {
                    clearInterval(this.gameInterval);
                }
                
                // Iniciar bucle del juego
                this.gameInterval = setInterval(() => this.gameLoop(), 150);
            }
            
            generateFood() {
                let newFood;
                let validPosition = false;
                let attempts = 0;
                const maxAttempts = 200; // Aumentado para evitar problemas
                
                while (!validPosition && attempts < maxAttempts) {
                    attempts++;
                    const x = Math.floor(Math.random() * (this.canvas.width / this.box)) * this.box;
                    const y = Math.floor(Math.random() * (this.canvas.height / this.box)) * this.box;
                    
                    newFood = { x, y };
                    
                    // Verificar que la comida no esté en la serpiente
                    validPosition = !this.snake.some(segment => segment.x === x && segment.y === y);
                }
                
                // Si no se encontró una posición válida después de muchos intentos,
                // usar una posición por defecto
                if (!validPosition) {
                    newFood = { x: this.box * 3, y: this.box * 3 };
                    
                    // Asegurarse de que no esté en la serpiente
                    while (this.snake.some(segment => segment.x === newFood.x && segment.y === newFood.y)) {
                        newFood.x += this.box;
                        if (newFood.x >= this.canvas.width) {
                            newFood.x = this.box;
                            newFood.y += this.box;
                        }
                        if (newFood.y >= this.canvas.height) {
                            newFood.y = this.box;
                        }
                    }
                }
                
                return newFood;
            }
            
            gameLoop() {
                if (this.isPaused) return;
                
                this.moveSnake();
                this.checkCollision();
                this.draw();
            }
            
            moveSnake() {
                const head = { x: this.snake[0].x + this.dx, y: this.snake[0].y + this.dy };
                this.snake.unshift(head);
                
                // Comprobar si come la comida
                if (head.x === this.food.x && head.y === this.food.y) {
                    this.score += 10;
                    this.scoreDisplay.textContent = this.score;
                    
                    // Generar nueva comida
                    this.food = this.generateFood();
                } else {
                    this.snake.pop();
                }
            }
            
            checkCollision() {
                const head = this.snake[0];
                
                // Colisión con los bordes
                if (
                    head.x < 0 || 
                    head.y < 0 || 
                    head.x >= this.canvas.width || 
                    head.y >= this.canvas.height
                ) {
                    this.gameOver();
                    return;
                }
                
                // Colisión consigo misma
                for (let i = 1; i < this.snake.length; i++) {
                    if (head.x === this.snake[i].x && head.y === this.snake[i].y) {
                        this.gameOver();
                        return;
                    }
                }
            }
            
            draw() {
                // Limpiar el canvas
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                // Dibujar la serpiente
                this.snake.forEach((segment, index) => {
                    if (index === 0) {
                        // Cabeza
                        this.ctx.fillStyle = '#ff5722';
                        this.ctx.fillRect(segment.x, segment.y, this.box, this.box);
                        
                        // Ojos
                        this.ctx.fillStyle = '#000';
                        this.ctx.fillRect(segment.x + 4, segment.y + 4, 4, 4);
                        this.ctx.fillRect(segment.x + 12, segment.y + 4, 4, 4);
                    } else {
                        // Cuerpo
                        this.ctx.fillStyle = '#4caf50';
                        this.ctx.fillRect(segment.x, segment.y, this.box, this.box);
                        this.ctx.fillStyle = '#387c48';
                        this.ctx.fillRect(segment.x + 2, segment.y + 2, this.box - 4, this.box - 4);
                    }
                });
                
                // Dibujar la comida
                this.ctx.fillStyle = '#ff0000';
                this.ctx.beginPath();
                this.ctx.arc(this.food.x + this.box/2, this.food.y + this.box/2, this.box/2, 0, Math.PI * 2);
                this.ctx.fill();
                
                // Tallo
                this.ctx.fillStyle = '#00ff00';
                this.ctx.fillRect(this.food.x + this.box/2 - 2, this.food.y - 3, 4, 5);
                
                // Dibujar información del juego
                this.ctx.fillStyle = '#ffffff';
                this.ctx.font = '12px "Press Start 2P", cursive';
                this.ctx.textAlign = 'left';
                this.ctx.fillText(`Puntos: ${this.score}`, 10, 20);
            }
            
            gameOver() {
                clearInterval(this.gameInterval);
                this.gameStarted = false;
                
                // Ocultar botón de pausa
                this.pauseButton.classList.add('hidden');
                
                // Mostrar pantalla de game over
                this.gameOverScreen.classList.remove('hidden');
                this.finalScoreDisplay.textContent = this.score;
                
                // Actualizar record si es necesario
                if (this.score > this.highScore) {
                    this.highScore = this.score;
                    this.highScoreDisplay.textContent = this.highScore;
                    localStorage.setItem('snakeHighScore', this.highScore);
                }
            }
            
            togglePause() {
                this.isPaused = !this.isPaused;
                
                if (this.isPaused) {
                    this.pauseScreen.classList.remove('hidden');
                } else {
                    this.pauseScreen.classList.add('hidden');
                }
            }
            
            handleKeyDown(e) {
                if (!this.gameStarted) return;
                
                if (e.key === 'p' || e.key === 'P') {
                    this.togglePause();
                    return;
                }
                
                if (this.isPaused) return;
                
                // Control de dirección
                const key = e.key;
                const goingUp = this.dy === -this.box;
                const goingDown = this.dy === this.box;
                const goingRight = this.dx === this.box;
                const goingLeft = this.dx === -this.box;
                
                if ((key === 'ArrowLeft' || key === 'a' || key === 'A') && !goingRight) {
                    this.dx = -this.box;
                    this.dy = 0;
                } else if ((key === 'ArrowUp' || key === 'w' || key === 'W') && !goingDown) {
                    this.dx = 0;
                    this.dy = -this.box;
                } else if ((key === 'ArrowRight' || key === 'd' || key === 'D') && !goingLeft) {
                    this.dx = this.box;
                    this.dy = 0;
                } else if ((key === 'ArrowDown' || key === 's' || key === 'S') && !goingUp) {
                    this.dx = 0;
                    this.dy = this.box;
                }
            }
            
            handleDirectionButton(direction) {
                if (!this.gameStarted || this.isPaused) return;
                
                const goingUp = this.dy === -this.box;
                const goingDown = this.dy === this.box;
                const goingRight = this.dx === this.box;
                const goingLeft = this.dx === -this.box;
                
                switch (direction) {
                    case 'left':
                        if (!goingRight) {
                            this.dx = -this.box;
                            this.dy = 0;
                        }
                        break;
                    case 'up':
                        if (!goingDown) {
                            this.dx = 0;
                            this.dy = -this.box;
                        }
                        break;
                    case 'right':
                        if (!goingLeft) {
                            this.dx = this.box;
                            this.dy = 0;
                        }
                        break;
                    case 'down':
                        if (!goingUp) {
                            this.dx = 0;
                            this.dy = this.box;
                        }
                        break;
                }
            }
            
            handleTouchStart(e) {
                this.touchStartX = e.touches[0].clientX;
                this.touchStartY = e.touches[0].clientY;
                
                if (this.gameStarted && !this.isPaused) {
                    e.preventDefault();
                }
            }
            
            handleTouchMove(e) {
                if (!this.gameStarted || this.isPaused) return;
                
                e.preventDefault();
                
                const touchEndX = e.touches[0].clientX;
                const touchEndY = e.touches[0].clientY;
                
                const dx = touchEndX - this.touchStartX;
                const dy = touchEndY - this.touchStartY;
                
                // Determinar la dirección del deslizamiento
                if (Math.abs(dx) > Math.abs(dy)) {
                    if (dx > 0 && this.dx !== -this.box) {
                        // Deslizar a la derecha
                        this.dx = this.box;
                        this.dy = 0;
                    } else if (dx < 0 && this.dx !== this.box) {
                        // Deslizar a la izquierda
                        this.dx = -this.box;
                        this.dy = 0;
                    }
                } else {
                    if (dy > 0 && this.dy !== -this.box) {
                        // Deslizar hacia abajo
                        this.dx = 0;
                        this.dy = this.box;
                    } else if (dy < 0 && this.dy !== this.box) {
                        // Deslizar hacia arriba
                        this.dx = 0;
                        this.dy = -this.box;
                    }
                }
                
                // Actualizar posición inicial para el próximo movimiento
                this.touchStartX = touchEndX;
                this.touchStartY = touchEndY;
            }
        }
        
        // Iniciar el juego cuando se carga la página
        window.addEventListener('load', () => {
            const game = new SnakeGame();
        });
    </script>
</body>
</html>